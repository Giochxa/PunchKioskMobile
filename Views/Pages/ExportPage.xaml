<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="PunchKioskMobile.Views.Pages.ExportPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="Export Data">
    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="20">

            <Label Text="Export Punch Data" 
                   FontSize="24" 
                   FontAttributes="Bold" 
                   HorizontalOptions="Center" />

            <Frame BackgroundColor="#F0F8FF" Padding="15">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Select Date Range" 
                           FontSize="16" 
                           FontAttributes="Bold" />

                    <Label Text="Start Date:" />
                    <DatePicker Date="{Binding StartDate}"
                                Format="yyyy-MM-dd" />

                    <Label Text="End Date:" />
                    <DatePicker Date="{Binding EndDate}"
                                Format="yyyy-MM-dd" />

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Button Text="Export to CSV" 
                                Command="{Binding ExportCsvCommand}"
                                IsEnabled="{Binding IsNotBusy}"
                                BackgroundColor="#007ACC"
                                TextColor="White" />

                        <Button Grid.Column="1"
                                Text="Export to Excel" 
                                Command="{Binding ExportExcelCommand}"
                                IsEnabled="{Binding IsNotBusy}"
                                BackgroundColor="#217346"
                                TextColor="White" />
                    </Grid>

                    <ActivityIndicator IsVisible="{Binding IsExporting}"
                                     IsRunning="{Binding IsExporting}"
                                     HorizontalOptions="Center" />
                </VerticalStackLayout>
            </Frame>

            <Frame IsVisible="{Binding ShowSuccess}"
                   BackgroundColor="#DFF2BF"
                   Padding="15">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Export Successful!" 
                           TextColor="#4F8A10"
                           FontAttributes="Bold" />
                    <Label Text="{Binding ExportResult}" 
                           TextColor="#4F8A10" />
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>